<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Vtranslation — Editor</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="topbar">
    <h1>Vtranslation — Editor</h1>
    <div class="auth">
      <input id="pat" type="password" placeholder="GitHub Personal Access Token (PAT)" aria-label="GitHub PAT">
      <button id="connectBtn">Connect</button>
      <button id="disconnectBtn" style="display:none">Disconnect</button>
      <div id="authStatus" class="muted">Not connected</div>
    </div>
  </header>

  <main class="container">
    <section class="instructions">
      <h2>Publishing via GitHub</h2>
      <p>To publish directly from this editor you need a GitHub Personal Access Token (PAT). Create a token at <a href="https://github.com/settings/tokens" target="_blank" rel="noopener">github.com/settings/tokens</a>. The token should have <strong>repo</strong> scope (full control of private repositories if needed).</p>
      <p>Paste the token into the field above and click <strong>Connect</strong>. The token is stored only in this browser session (sessionStorage) and never sent to third parties except GitHub's API.</p>
    </section>

    <section class="editor">
      <label>File path (relative to repo root):
        <input id="filePath" type="text" placeholder="books/my-book/book.json">
      </label>

      <label>Book title:
        <input id="bookTitle" type="text" placeholder="My Book Title">
      </label>

      <label>Author:
        <input id="bookAuthor" type="text" placeholder="Author Name">
      </label>

      <label>Content (JSON or text):
        <textarea id="fileContent" rows="18" placeholder='{"chapters": []}'></textarea>
      </label>

      <div class="actions">
        <button id="publishBtn">Publish File to GitHub</button>
        <button id="publishAndUpdateBooksBtn">Publish + Update books.json</button>
      </div>

      <div id="result" class="result muted"></div>
    </section>

    <section class="notes">
      <h3>Notes</h3>
      <ul>
        <li>The editor will create or update files on the <code>main</code> branch of the repository <strong>Mukuro-Rokudo/Vtranslation-mini-app</strong>.</li>
        <li>When updating books.json, an entry for the published file will be added or updated with the title, author and timestamp.</li>
        <li>To disconnect, click <em>Disconnect</em>. This clears the token from sessionStorage.</li>
      </ul>
    </section>
  </main>

  <script src="editor.js"></script>
</body>
</html>